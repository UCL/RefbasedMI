----------------------------------------------------------------------------------------------------------------------------------
      name:  <unnamed>
       log:  C:\ado\ian\myRmimix\test\allmissing_Stata.log
  log type:  text
 opened on:  29 Mar 2021, 11:34:26

. /*
> What does mimix do when an observation is wholly missing?
> When ref = that arm: 
>         LMCF = MAR at time 1 only
>         J2R, CIR and CR all = MAR at all times
> When ref = other arm: 
>         MAR and LMCF are same as for "ref = that arm"
>         J2R = CIR at all times but not equal to MAR
>         CR different from everything else 
> We can use this to test the R code
> IW updated 29mar2021
> Takes individual 5001 in placebo arm and sets to wholly missing
> */
. label list treat1
treat1:
           2 Placebo
           3 Active

. foreach ref in 2 3 {
  2.         di as input "Ref = `ref'"
  3.         foreach method in mar lmcf j2r  cir cr {
  4.                 di as input "Method = `method'" _c
  5.                 use c:\stata\asthma, clear
  6.                 qui replace fev=. if id==5001
  7.                 qui mimix fev treat, id(id) time(time) method(`method') ref(`ref') covariates(base) clear m(1) seed(101)
  8.                 qui mi reshape wide fev, i(id) j(time)
  9.                 l if id==5001
 10.         }
 11. }
Ref = 2
Method = mar
     +-----------------------------------------------------------------------------------------------+
     |   id      fev2       fev4       fev8      fev12     treat    base   _mi_id   _mi_miss   _mi_m |
     |-----------------------------------------------------------------------------------------------|
  1. | 5001         .          .          .          .   Placebo   2.925        1          1       0 |
184. | 5001   2.29255   2.819713   2.268666   2.134381   Placebo   2.925        1          .       1 |
     +-----------------------------------------------------------------------------------------------+
Method = lmcf
     +----------------------------------------------------------------------------------------------+
     |   id      fev2       fev4      fev8      fev12     treat    base   _mi_id   _mi_miss   _mi_m |
     |----------------------------------------------------------------------------------------------|
  1. | 5001         .          .         .          .   Placebo   2.925        1          1       0 |
184. | 5001   2.29255   2.898978   2.32183   2.187569   Placebo   2.925        1          .       1 |
     +----------------------------------------------------------------------------------------------+
Method = j2r
     +-----------------------------------------------------------------------------------------------+
     |   id      fev2       fev4       fev8      fev12     treat    base   _mi_id   _mi_miss   _mi_m |
     |-----------------------------------------------------------------------------------------------|
  1. | 5001         .          .          .          .   Placebo   2.925        1          1       0 |
184. | 5001   2.29255   2.819713   2.268666   2.134381   Placebo   2.925        1          .       1 |
     +-----------------------------------------------------------------------------------------------+
Method = cir
     +-----------------------------------------------------------------------------------------------+
     |   id      fev2       fev4       fev8      fev12     treat    base   _mi_id   _mi_miss   _mi_m |
     |-----------------------------------------------------------------------------------------------|
  1. | 5001         .          .          .          .   Placebo   2.925        1          1       0 |
184. | 5001   2.29255   2.819713   2.268666   2.134381   Placebo   2.925        1          .       1 |
     +-----------------------------------------------------------------------------------------------+
Method = cr
     +-----------------------------------------------------------------------------------------------+
     |   id      fev2       fev4       fev8      fev12     treat    base   _mi_id   _mi_miss   _mi_m |
     |-----------------------------------------------------------------------------------------------|
  1. | 5001         .          .          .          .   Placebo   2.925        1          1       0 |
184. | 5001   2.29255   2.819713   2.268666   2.134381   Placebo   2.925        1          .       1 |
     +-----------------------------------------------------------------------------------------------+
Ref = 3
Method = mar
     +-----------------------------------------------------------------------------------------------+
     |   id      fev2       fev4       fev8      fev12     treat    base   _mi_id   _mi_miss   _mi_m |
     |-----------------------------------------------------------------------------------------------|
  1. | 5001         .          .          .          .   Placebo   2.925        1          1       0 |
184. | 5001   2.29255   2.819713   2.268666   2.134381   Placebo   2.925        1          .       1 |
     +-----------------------------------------------------------------------------------------------+
Method = lmcf
     +----------------------------------------------------------------------------------------------+
     |   id      fev2       fev4      fev8      fev12     treat    base   _mi_id   _mi_miss   _mi_m |
     |----------------------------------------------------------------------------------------------|
  1. | 5001         .          .         .          .   Placebo   2.925        1          1       0 |
184. | 5001   2.29255   2.898978   2.32183   2.187569   Placebo   2.925        1          .       1 |
     +----------------------------------------------------------------------------------------------+
Method = j2r
     +------------------------------------------------------------------------------------------------+
     |   id       fev2       fev4       fev8      fev12     treat    base   _mi_id   _mi_miss   _mi_m |
     |------------------------------------------------------------------------------------------------|
  1. | 5001          .          .          .          .   Placebo   2.925        1          1       0 |
184. | 5001   2.575555   3.276191   2.856228   3.093786   Placebo   2.925        1          .       1 |
     +------------------------------------------------------------------------------------------------+
Method = cir
     +------------------------------------------------------------------------------------------------+
     |   id       fev2       fev4       fev8      fev12     treat    base   _mi_id   _mi_miss   _mi_m |
     |------------------------------------------------------------------------------------------------|
  1. | 5001          .          .          .          .   Placebo   2.925        1          1       0 |
184. | 5001   2.575555   3.276191   2.856228   3.093786   Placebo   2.925        1          .       1 |
     +------------------------------------------------------------------------------------------------+
Method = cr
     +-----------------------------------------------------------------------------------------------+
     |   id      fev2       fev4       fev8      fev12     treat    base   _mi_id   _mi_miss   _mi_m |
     |-----------------------------------------------------------------------------------------------|
  1. | 5001         .          .          .          .   Placebo   2.925        1          1       0 |
184. | 5001   2.72917   3.430901   3.020989   3.249763   Placebo   2.925        1          .       1 |
     +-----------------------------------------------------------------------------------------------+

. 
end of do-file
      name:  <unnamed>
       log:  C:\ado\ian\myRmimix\test\allmissing_Stata.log
  log type:  text
 closed on:  29 Mar 2021, 11:34:38
----------------------------------------------------------------------------------------------------------------------------------
